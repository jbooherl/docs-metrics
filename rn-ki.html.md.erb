---
title: PCF Metrics Release Notes and Known Issues
owner: PCF Metrics
list_style_none: true
---

<strong><%= modified_date %></strong>

This topic contains release notes for Pivotal Cloud Foundry (PCF) Metrics.

## <a id='1-6-4'></a>v1.6.4

**Release Date: March 3, 2020**
### <a name="1-6-4-issues"></a>Known Issues

#### Install Error if Upgrading in Offline Environment

If you are upgrading from Metrics v1.6.3, the buildpack is not replaced with the offline version.
Before installing v1.6.4, delete the appmetrics_nodejs8_buildpack with the cf cli.

Sometimes upgrading from other versions of Metrics will also run into an error with the buildpack.
If already installed, delete the appmetrics_nodejs8_buildpack with the cf cli and rerun the Push App Metrics Component Errand.

### Fixed Issues

<ul>
  <li>
    Resolves the <a href="#1-6-3-issues">Packaged Non-Offline Buildpack</a> issue.<br>
    PCF Metrics v1.6.4 can be used in air-gapped environments because it packages the offline Node.js buildpack v1.7.8.
    For more information, see <a href="./installing.html#prereqs">Prerequisites</a> in <em>Installing PCF Metrics</em>.
  </li>
</ul>

## <a id='1-6-3'></a>v1.6.3

**Release Date: Feburary 28, 2020**
### <a name="1-6-3-issues"></a>Known Issues

#### Packaged Non-Offline Buildpack

The Node.js buildpack requires the internet and does not work for air-gapped environments.

### Fixed Issues

<ul>
  <li>
    Resolves <a href="#issues">PCF Metrics v1.6.x Incompatibility with Node.js Buildpack</a>
    by packaging the Node.js buildpack v1.7.8 for non air-gapped environments.
    If you are upgrading from Metrics v1.6.3 you first need to delete the appmetrics_nodejs8_buildpack.
    For more information, see <a href="./installing.html#prereqs">Prerequisites</a> in <em>Installing PCF Metrics</em>.
  </li>
</ul>

## <a id='1-6-2'></a>v1.6.2

**Release Date: January 16, 2020**

### Fixed Issues

<ul>
<li>Resolves Postgres disk auto-pruning failures for new installs of PCF Metrics.</li>
</ul>

### Maintenance Updates

This release includes the following component version upgrades:

<ul>
<li>Upgrade pxc to version 0.21.0</li>
<li>Upgrade cf-cli to version 1.22.0</li>
<li>Upgrade bpm-release to version 1.6</li>
<li>Upgrade GoLang to version 1.13.5</li>
<li>Locked os-conf to version 20.0.0</li>
</ul>

## <a id='1-6-1'></a>v1.6.1

**Release Date: August 5, 2019**

### Known Issues

#### Postgres Pruning Failure in v1.6.1

The Postgreslog store disk size errand is not being set on fresh installs of PCF Metrics v1.6.1 causing the auto-pruning feature to fail. A fix has been released in PCF Metrics v1.6.2.

Please note that this issue only applies to fresh installs of PCF Metrics v1.6.1. Upgrades to v1.6.1 from v1.5 or v1.6 versions will function correctly.

### Fixed Issues

<ul>
<li>This release addresses the issue in which the pushapps errand does not complete, stalling the installation of PCF Metrics.</li>
</ul>

### Maintenance Updates

This release includes the following component version upgrades:

<ul>
<li>Upgrade metrics data store to PXC version v0.15.0</li>
<li>Upgrade GoLang version v1.12.4</li>
<li>Upgrade to CF CLI v1.16.0</li>
</ul>

## <a id='1-6-0'></a>v1.6.0

**Release Date: January 10, 2019**

### <a name="new-features"></a>New Features in PCF Metrics v1.6

The following list describes what's new in PCF Metrics v1.6:

* Support for automated application metric and event monitors configuration
* Improved logs datastore integrity via configurable Postgres Pruning
* Ability to configure the PCF Metrics tile to forward logs to a syslog endpoint (for PCF 2.4 and beyond)
* Xenial stemcell support

### <a name="issues"></a>Known Issues

The following sections describe the known issues in PCF Metrics v1.6.x.

#### PCF Metrics v1.6.x Incompatibility with Node.js Buildpack

PCF Metrics v1.6.x depends on Node.js 8.x, which is removed in Node.js buildpacks after [v1.7.8](https://github.com/cloudfoundry/nodejs-buildpack/releases/tag/v1.7.8).

Upgrading to PAS v2.6.15+, PAS v2.7.9+, or PAS v2.8.3+ prevents PCF Metrics from successfully deploying.

For more information and potential workarounds, see [PCF Metrics v1.6.x is not compatible with PAS 2.6.15+, 2.7.9+ & 2.8.3+](https://community.pivotal.io/s/article/PCF-Metrics-not-compatible-with-PAS).

#### Postgres Pruning Failure in v1.6.1

The Postgreslog store disk size errand is not being set on fresh installs of PCF Metrics v1.6.1 causing the auto-pruning feature to fail. A fix has been released in PCF Metrics v1.6.2.

Please note that this issue only applies to fresh installs of PCF Metrics v1.6.1. Upgrades to v1.6.1 from v1.5 or v1.6 versions will function correctly.

#### Upgrade Compatibility with PCF Metrics v1.4

In order to successfully run both PCF Metrics v1.4 and v1.6 simultaneously during the upgrade period, ensure the v1.4 tile is updated to v1.4.6 or later. v1.4.5 and older will not support the secondary metrics URL `metrics-previous.YOUR-SYSTEM-DOMAIN` that allows the v1.4 dashboard to be viewed.

For more information about upgrading to PCF Metrics v1.6, see [Installing PCF Metrics](installing.html#upgrade).

#### Postgres Logs Data Store Capacity Issue when Upgrading from v1.5.1 or v1.5.2 to v1.6.0

When you upgrade from PCF Metrics v1.5.1 or v1.5.2 to v1.6.0, the Postgres logs data store may fill up unexpectedly. This issue occurs even with pruning enabled.

To resolve this issue on upgrades from v1.5.1 to v1.6.0, delete the following Postgres volumes:

```
/var/vcap/store/postgres/postgres-previous
/var/vcap/store/postgres/postgres-9.6.8
/var/vcap/store/postgres/pg_upgrade_tmp
```

To resolve this issue on upgrades from v1.5.2 to v1.6.0, delete the following Postgres volumes:

```
/var/vcap/store/postgres/postgres-previous
/var/vcap/store/postgres/postgres-11.1
/var/vcap/store/postgres/pg_upgrade_tmp
```

#### Push Apps Errand Doesn't Complete

We are currently investigating an issue in PCF Metrics where the push apps errand does not complete, stalling the installation of PCF Metrics.

If the errand hangs on new installations of PCF Metrics v1.6, please kill the errand and attempt your installation again.

Once PCF Metrics v1.6 has been successfully installed, this errand can be disabled for subsequent builds of PCF Metrics.

<p class="note"><strong>Note</strong>: This issue is resolved in the PCF Metrics v1.6.1 release.</p>

#### Triggered Monitor Notifications (Beta) via Webhook with Proxy Settings

Metric and Event Monitors (Beta) will currently not send notifications to configured webhook URLs while `http_proxy` settings are enabled.

#### Using Custom App Metrics

To use visualize custom app metrics in PCF Metrics, you must take additional steps in order to emit these metrics and make them available through the Loggregator Firehose. You can use PCF Metrics without these additional steps, but you will be able to view only default container metrics, network metrics, and app events.

For more information about how to configure apps to emit custom metrics on PCF v2.2 through v2.4, see [Metrics Forwarder for PCF](https://docs.pivotal.io/metrics-forwarder/index.html).

For more information about how to configure apps to emit custom metrics on PCF v2.5 and later, see [Configuring the Metric Registrar](https://docs.pivotal.io/pivotalcf/metric-registrar/index.html).

#### Delay in Ingesting Metrics

To prevent metrics data backup in Redis, ensure that each app does not emit more than 400 metrics per minute. For deployments with a high number of apps, you may still experience a delay of up to 1-2 hours before metrics data appears on the dashboard.

#### Logs Data Availability During Postgres Scaling

When you vertically scale your Postgres instance in PCF Metrics v1.6, Postgres enters an unhealthy period during which it does not ingest any new logs data until the scaling operation has completed.

For more information about scaling the Logs Postgres datastore, see [Sizing PCF Metrics for your System](sizing.html#log-datastore).

#### Data Loss During Stemcell Upgrades

No metrics or logs data will be ingested during a stemcell or VM update. In tests on tile environments, stemcell updates resulted in approximately 9 minutes where logs data was not ingested.

#### Logs Data Export Limitation

Due to security, call pagination, and resource constraints, downloaded logs are limited to 10,000 log-line entries. If you need to export more logs data, we suggest looking directly at the [Loggregator Firehose](https://docs.pivotal.io/pivotalcf/loggregator/architecture.html#firehose) or utilizing the [Log Cache CLI](https://github.com/cloudfoundry/log-cache-cli).

#### Smoke Test Failures Due to User Authentication

The PCF Metrics **Smoke Test** errand may fail if your deployment authenticates user sign-ons with an external SAML identity provider or an external LDAP server.
In some cases, these external user stores have an additional login procedure that prevents the errand from authenticating with the deployment and validating against the Metrics API.

If you experience this issue, disable the **Smoke Test** errand in the PCF Metrics tile and click **Apply Changes** to run the install again.

For more information about what configurations lead to this failure,
see [Configure Authentication and Enterprise SSO](http://docs.pivotal.io/pivotalcf/customizing/config-er-vmware.html#er-auth-config) in Configuring Elastic Runtime.

#### For Operators Who Deploy PCF Metrics Using BOSH

If both of the following are true, you might experience issues while using PCF Metrics:

* You deploy PCF Metrics using BOSH instead of using the PCF Metrics tile in Ops Manager.
* You use self-signed certificates.

Pivotal recommends using certificates issued by a Certificate Authority for BOSH deployments of this product.

## <a id="14x"></a>Past Minor v1.5.x

Release Notes for v1.5.x releases can be found [here](http://docs.pivotal.io/app-metrics/1-5/rn-ki.html).

## <a id="14x"></a>Past Minor v1.4.x

Release Notes for v1.4.x releases can be found [here](http://docs.pivotal.io/app-metrics/1-4/rn-ki.html).

## <a id="13x"></a>Past Minor v1.3.x

Release Notes for v1.3.x releases can be found [here](http://docs.pivotal.io/app-metrics/1-3/rn-ki.html).

## <a id="12x"></a>Past Minor v1.2.x

Release Notes for v1.2.x releases can be found [here](http://docs.pivotal.io/app-metrics/1-2/rn-ki.html).

## <a id="11x"></a>Past Minor v1.1.x

Release Notes for v1.1.x releases can be found [here](http://docs.pivotal.io/app-metrics/1-1/rn-ki.html).

## <a id="10x"></a>Past Minor v1.0.x

Release Notes for v1.0.x releases can be found [here](http://docs.pivotal.io/app-metrics/1-0/rn-ki.html).
